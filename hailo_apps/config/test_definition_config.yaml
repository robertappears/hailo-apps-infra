# ============================================================================
# TEST DEFINITION CONFIGURATION
# ============================================================================
# Defines the structure, test suites, resources, and app combinations for testing

# Application definitions
apps:
  detection:
    name: "Object Detection Pipeline"
    description: "Object Detection Pipeline"
    module: "hailo_apps.python.pipeline_apps.detection.detection"
    script: "hailo_apps/python/pipeline_apps/detection/detection.py"
    cli: "hailo-detect"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "input_video_with_labels"
      - "input_video_hef_labels"
      - "pipeline_disable_sync"
      - "pipeline_disable_callback"
      - "full_combination_video_hef_labels_sync"

  simple_detection:
    name: "Simple Detection Pipeline"
    description: "Simple Detection Pipeline"
    module: "hailo_apps.python.pipeline_apps.detection_simple.detection_simple"
    script: "hailo_apps/python/pipeline_apps/detection_simple/detection_simple.py"
    cli: "hailo-detect-simple"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "input_video_with_labels"
      - "pipeline_disable_sync"

  face_recognition:
    name: "Face Recognition Pipeline"
    description: "Face Recognition Pipeline (multi-model: scrfd + arcface)"
    module: "hailo_apps.python.pipeline_apps.face_recognition.face_recognition"
    script: "hailo_apps/python/pipeline_apps/face_recognition/face_recognition.py"
    cli: "hailo-face-recon"
    # Multi-model app: test framework auto-detects and passes all HEF paths
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "input_video_with_hef"
    extra_test_suites:
      - "basic_input_usb"
      - "face_mode_train"
      - "input_video_mode_train"
      - "pipeline_disable_sync"

  instance_segmentation:
    name: "Instance Segmentation Pipeline"
    description: "Instance Segmentation Pipeline"
    module: "hailo_apps.python.pipeline_apps.instance_segmentation.instance_segmentation"
    script: "hailo_apps/python/pipeline_apps/instance_segmentation/instance_segmentation.py"
    cli: "hailo-seg"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "with_labels_json"
      - "with_batch_size_2"
      - "pipeline_disable_sync"

  pose_estimation:
    name: "Pose Estimation Pipeline"
    description: "Pose Estimation Pipeline"
    module: "hailo_apps.python.pipeline_apps.pose_estimation.pose_estimation"
    script: "hailo_apps/python/pipeline_apps/pose_estimation/pose_estimation.py"
    cli: "hailo-pose"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "with_batch_size_2"
      - "pipeline_disable_sync"

  depth:
    name: "Depth Estimation Pipeline"
    description: "Depth Estimation Pipeline"
    module: "hailo_apps.python.pipeline_apps.depth.depth"
    script: "hailo_apps/python/pipeline_apps/depth/depth.py"
    cli: "hailo-depth"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "pipeline_disable_callback"

  tiling:
    name: "Tiling Pipeline"
    description: "Tiling Pipeline"
    module: "hailo_apps.python.pipeline_apps.tiling.tiling"
    script: "hailo_apps/python/pipeline_apps/tiling/tiling.py"
    cli: "hailo-tiling"
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "basic_input_usb"
      - "input_video_with_hef"
    extra_test_suites:
      - "tiling_general_detection"
      - "tiling_tiles_2x2"
      - "tiling_multi_scale"
      - "with_labels_json"

  paddle_ocr:
    name: "Paddle OCR Pipeline"
    description: "Paddle OCR Pipeline (multi-model: ocr_det + ocr)"
    module: "hailo_apps.python.pipeline_apps.paddle_ocr.paddle_ocr"
    script: "hailo_apps/python/pipeline_apps/paddle_ocr/paddle_ocr.py"
    cli: "hailo-ocr"
    # Multi-model app: test framework auto-detects and passes all HEF paths
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "input_video_with_hef"
      - "basic_input_usb"
    extra_test_suites:
      - "pipeline_disable_sync"

  clip:
    name: "CLIP Pipeline"
    description: "CLIP Pipeline (multi-model: clip_encoder + detector)"
    module: "hailo_apps.python.pipeline_apps.clip.clip"
    script: "hailo_apps/python/pipeline_apps/clip/clip.py"
    cli: "hailo-clip"
    # Multi-model app: test framework auto-detects and passes all HEF paths
    default_test_suites:
      - "basic_show_fps"
      - "basic_input_video"
      - "clip_detector_none"
      - "basic_input_usb"
      - "clip_detector_person"
    extra_test_suites: []




  reid_multisource:
    name: "REID Multisource Pipeline"
    description: "REID Multisource Pipeline (multi-model: scrfd + arcface)"
    module: "hailo_apps.python.pipeline_apps.reid_multisource.reid_multisource"
    script: "hailo_apps/python/pipeline_apps/reid_multisource/reid_multisource.py"
    cli: "hailo-reid"
    # Multi-model app: test framework auto-detects and passes all HEF paths
    # Note: multisource tests require video device (e.g., /dev/video0)
    default_test_suites:
      - "basic_show_fps"
    extra_test_suites:
      - "multisource_single"
      - "multisource_multiple"

  object_detection_standalone:
    name: "Object Detection Standalone"
    description: "Standalone object detection app"
    module: "hailo_apps.python.standalone_apps.object_detection.object_detection"
    script: "hailo_apps/python/standalone_apps/object_detection/object_detection.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
      - "input_video_with_hef"
    extra_test_suites: []

  instance_segmentation_standalone:
    name: "Instance Segmentation Standalone"
    description: "Standalone instance segmentation app"
    module: "hailo_apps.python.standalone_apps.instance_segmentation.instance_segmentation"
    script: "hailo_apps/python/standalone_apps/instance_segmentation/instance_segmentation.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
      - "input_video_with_hef"
    extra_test_suites: []

  pose_estimation_standalone:
    name: "Pose Estimation Standalone"
    description: "Standalone pose estimation app"
    module: "hailo_apps.python.standalone_apps.pose_estimation.pose_estimation"
    script: "hailo_apps/python/standalone_apps/pose_estimation/pose_estimation.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
      - "input_video_with_hef"
    extra_test_suites: []

  lane_detection_standalone:
    name: "Lane Detection Standalone"
    description: "Standalone lane detection app"
    module: "hailo_apps.python.standalone_apps.lane_detection.lane_detection"
    script: "hailo_apps/python/standalone_apps/lane_detection/lane_detection.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
      - "input_video_with_hef"
    extra_test_suites: []

  super_resolution_standalone:
    name: "Super Resolution Standalone"
    description: "Standalone super resolution app"
    module: "hailo_apps.python.standalone_apps.super_resolution.super_resolution"
    script: "hailo_apps/python/standalone_apps/super_resolution/super_resolution.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
      - "input_video_with_hef"
    extra_test_suites: []

  paddle_ocr_standalone:
    name: "Paddle OCR Standalone"
    description: "Standalone Paddle OCR app (multi-model)"
    module: "hailo_apps.python.standalone_apps.paddle_ocr.paddle_ocr"
    script: "hailo_apps/python/standalone_apps/paddle_ocr/paddle_ocr.py"
    cli: ""
    default_test_suites:
      - "basic_image_smoke"
      - "basic_show_fps"
    extra_test_suites: []

# Test suites with flag combinations (aligned with FLAG_COMBINATIONS.md)
test_suites:
  # Basic combinations (from FLAG_COMBINATIONS.md)
  basic_show_fps:
    flags:
      - "--show-fps"
    description: "Basic test with FPS display"

  basic_input_video:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--show-fps"
    description: "Basic: input video file with FPS"

  basic_input_usb:
    flags:
      - "--input"
      - "usb"
      - "--show-fps"
    description: "Basic: USB camera input with FPS"

  basic_input_rpi:
    flags:
      - "--input"
      - "rpi"
      - "--show-fps"
    description: "Basic: Raspberry Pi camera input with FPS"

  basic_image_smoke:
    flags: []
    description: "Standalone: image-based smoke test with defaults (no extra flags)"

  # With HEF path combinations
  with_hef_path:
    flags:
      - "--hef-path"
      - "${HEF_PATH}"
      - "--show-fps"
    description: "With HEF path explicitly specified"

  input_video_with_hef:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--show-fps"
    description: "Video file with explicit HEF path"

  input_usb_with_hef:
    flags:
      - "--input"
      - "usb"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--show-fps"
    description: "USB camera with explicit HEF path"

  input_rpi_with_hef:
    flags:
      - "--input"
      - "rpi"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--show-fps"
    description: "RPi camera with explicit HEF path"

  # Pipeline flag combinations (from Pipeline Parser Flags section)
  pipeline_disable_sync:
    flags:
      - "--disable-sync"
      - "--show-fps"
    description: "Pipeline: disable synchronization"

  pipeline_disable_callback:
    flags:
      - "--disable-callback"
      - "--show-fps"
    description: "Pipeline: disable callback"

  pipeline_use_frame:
    flags:
      - "--use-frame"
      - "--show-fps"
    description: "Pipeline: enable frame access"

  pipeline_dump_dot:
    flags:
      - "--dump-dot"
      - "--show-fps"
    description: "Pipeline: export pipeline graph"

  pipeline_disable_sync_callback:
    flags:
      - "--disable-sync"
      - "--disable-callback"
      - "--show-fps"
    description: "Pipeline: disable sync and callback"

  pipeline_disable_sync_use_frame:
    flags:
      - "--disable-sync"
      - "--use-frame"
      - "--show-fps"
    description: "Pipeline: disable sync with frame access"

  pipeline_all_flags:
    flags:
      - "--disable-sync"
      - "--disable-callback"
      - "--use-frame"
      - "--dump-dot"
      - "--show-fps"
    description: "Pipeline: all pipeline flags combined"

  # App-specific flag combinations
  # Detection/Simple Detection: labels-json
  with_labels_json:
    flags:
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "With labels JSON file (detection apps)"

  input_video_with_labels:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "Video file with labels JSON"

  input_usb_with_labels:
    flags:
      - "--input"
      - "usb"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "USB camera with labels JSON"

  input_rpi_with_labels:
    flags:
      - "--input"
      - "rpi"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "RPi camera with labels JSON"

  input_video_hef_labels:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "Video file with HEF and labels JSON"

  input_usb_hef_labels:
    flags:
      - "--input"
      - "usb"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--show-fps"
    description: "USB camera with HEF and labels JSON"

  # Face Recognition: mode combinations
  face_mode_train:
    flags:
      - "--mode"
      - "train"
      - "--show-fps"
    description: "Face recognition: training mode"

  face_mode_delete:
    flags:
      - "--mode"
      - "delete"
      - "--show-fps"
    description: "Face recognition: delete mode"

  input_video_mode_train:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--mode"
      - "train"
      - "--show-fps"
    description: "Video file with training mode"

  input_usb_mode_train:
    flags:
      - "--input"
      - "usb"
      - "--mode"
      - "train"
      - "--show-fps"
    description: "USB camera with training mode"

  # Instance Segmentation/Pose Estimation: batch size
  with_batch_size_2:
    flags:
      - "--batch-size"
      - "2"
      - "--show-fps"
    description: "With batch size 2"

  with_batch_size_4:
    flags:
      - "--batch-size"
      - "4"
      - "--show-fps"
    description: "With batch size 4"

  input_video_batch_size_2:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--batch-size"
      - "2"
      - "--show-fps"
    description: "Video file with batch size 2"

  # Tiling: specific flags
  tiling_general_detection:
    flags:
      - "--general-detection"
      - "--show-fps"
    description: "Tiling: general detection mode"

  tiling_tiles_2x2:
    flags:
      - "--tiles-x"
      - "2"
      - "--tiles-y"
      - "2"
      - "--show-fps"
    description: "Tiling: manual 2x2 tiles"

  tiling_tiles_3x3:
    flags:
      - "--tiles-x"
      - "3"
      - "--tiles-y"
      - "3"
      - "--show-fps"
    description: "Tiling: manual 3x3 tiles"

  tiling_multi_scale:
    flags:
      - "--multi-scale"
      - "--show-fps"
    description: "Tiling: multi-scale mode"

  tiling_multi_scale_levels_2:
    flags:
      - "--multi-scale"
      - "--scale-levels"
      - "2"
      - "--show-fps"
    description: "Tiling: multi-scale with 2 levels"

  tiling_multi_scale_levels_3:
    flags:
      - "--multi-scale"
      - "--scale-levels"
      - "3"
      - "--show-fps"
    description: "Tiling: multi-scale with 3 levels"

  # CLIP: detector combinations
  clip_detector_none:
    flags:
      - "--detector"
      - "none"
      - "--show-fps"
    description: "CLIP: no detector"

  clip_detector_person:
    flags:
      - "--detector"
      - "person"
      - "--show-fps"
    description: "CLIP: person detector"


  # Multisource/REID: sources
  multisource_single:
    flags:
      - "--sources"
      - "/dev/video0"
      - "--show-fps"
    description: "Multisource: single source"

  multisource_multiple:
    flags:
      - "--sources"
      - "/dev/video0,${VIDEO_PATH}"
      - "--show-fps"
    description: "Multisource: multiple sources"

  # Base parser combinations
  with_width_height:
    flags:
      - "--width"
      - "640"
      - "--height"
      - "640"
      - "--show-fps"
    description: "With custom resolution (640x640)"

  with_frame_rate:
    flags:
      - "--frame-rate"
      - "30"
      - "--show-fps"
    description: "With custom frame rate (30 FPS)"

  with_save_output:
    flags:
      - "--save-output"
      - "--show-fps"
    description: "With output file saving"

  with_arch_hailo8:
    flags:
      - "--arch"
      - "hailo8"
      - "--show-fps"
    description: "With Hailo8 architecture"

  with_arch_hailo8l:
    flags:
      - "--arch"
      - "hailo8l"
      - "--show-fps"
    description: "With Hailo8L architecture"

  with_arch_hailo10h:
    flags:
      - "--arch"
      - "hailo10h"
      - "--show-fps"
    description: "With Hailo10H architecture"

  # Full combinations (comprehensive tests)
  full_combination_video_hef_labels_sync:
    flags:
      - "--input"
      - "${VIDEO_PATH}"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--disable-sync"
      - "--show-fps"
    description: "Full combination: video, HEF, labels, disable sync"

  full_combination_usb_hef_labels_sync:
    flags:
      - "--input"
      - "usb"
      - "--hef-path"
      - "${HEF_PATH}"
      - "--labels-json"
      - "${LABELS_JSON_PATH}"
      - "--disable-sync"
      - "--show-fps"
    description: "Full combination: USB, HEF, labels, disable sync"

# Resources required for testing
resources:
  videos:
    - name: "example.mp4"
    - name: "example_640.mp4"
    - name: "face_recognition.mp4"
    - name: "ocr.mp4"
    - name: "tiling_visdrone_720p.mp4"
    - name: "barcode.mp4"

  photos:
    - name: "dog_bicycle.jpg"
    - name: "zidane.jpg"
    - name: "bus.jpg"
    - name: "input_image.png"
    - name: "ocr_img1.png"
    - name: "ocr_img2.png"

  json_files:
    - name: "hailo_4_classes.json"
    - name: "barcode_labels.json"
    - name: "scrfd.json"
    - name: "yolov5m_seg.json"
    - name: "yolov5n_seg.json"
    - name: "visdrone.json"

# Test run combinations (aligned with test_control.yaml test_combinations)
test_run_combinations:
  ci_run:
    name: "CI Run"
    apps:
      - detection
      - simple_detection
      - face_recognition
      - instance_segmentation
      - pose_estimation
      - depth
      - tiling
      - paddle_ocr
      - clip
      - retrain
      - lane_detection
      - super_resolution
      - reid_multisource
    test_suite_mode: "all"  # None | default | extra | all
    model_selection: "all"  # default | extra | all
    description: "CI run with all apps using all test suites and all models"

  all_default:
    name: "All Apps Default Mode"
    apps:
      - detection
      - simple_detection
      - face_recognition
      - instance_segmentation
      - pose_estimation
      - depth
      - tiling
      - paddle_ocr
      - clip
      - retrain
      - lane_detection
      - super_resolution
      - reid_multisource
    test_suite_mode: "default"  # None | default | extra | all
    model_selection: "default"  # default | extra | all
    description: "Run all apps with default test suites and default models only"

  all_extra:
    name: "All Apps Extra Mode"
    apps:
      - detection
      - simple_detection
      - face_recognition
      - instance_segmentation
      - pose_estimation
      - depth
      - tiling
      - paddle_ocr
      - clip
      - retrain
      - lane_detection
      - super_resolution
      - reid_multisource
    test_suite_mode: "extra"  # None | default | extra | all
    model_selection: "extra"  # default | extra | all
    description: "Run all apps with default and extra test suites and extra models"
